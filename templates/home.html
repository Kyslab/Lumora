{% extends "base.html" %}

{% block title %}Lumora - {{ 'Khu Trải Nghiệm Giáo Dục' if lang == 'vi' else 'Educational Experience Center' }}{% endblock %}

{% block content %}
<section class="relative h-screen overflow-hidden -mt-28 lg:-mt-32" id="hero-slider">
    <div class="slider-container absolute inset-0">
        {% if banners and banners|length > 0 %}
            {% for banner in banners %}
            <div class="slide {% if loop.first %}active{% endif %}" data-slide="{{ loop.index0 }}">
                <div class="absolute inset-0">
                    <img src="{{ banner.image_url }}" alt="{{ banner.title_vi if lang == 'vi' else banner.title_en }}" class="w-full h-full object-cover">
                    <div class="absolute inset-0 hero-gradient"></div>
                </div>
                <div class="slide-content relative h-full flex items-center">
                    <div class="container mx-auto px-4">
                        <div class="max-w-3xl text-white">
                            {% if banner.subtitle_vi or banner.subtitle_en %}
                            <span class="inline-block bg-accent text-dark px-4 py-1 rounded-full text-sm font-semibold mb-4">
                                {% if banner.icon %}<i class="{{ banner.icon }} mr-2"></i>{% endif %}
                                {{ banner.subtitle_vi if lang == 'vi' else banner.subtitle_en }}
                            </span>
                            {% endif %}
                            <h1 class="text-4xl md:text-6xl lg:text-7xl font-display font-bold mb-6 leading-tight">
                                {{ banner.title_vi if lang == 'vi' else banner.title_en }}
                            </h1>
                            {% if banner.description_vi or banner.description_en %}
                            <p class="text-xl md:text-2xl mb-8 text-gray-200">
                                {{ banner.description_vi if lang == 'vi' else banner.description_en }}
                            </p>
                            {% endif %}
                            {% if banner.button_text_vi or banner.button_text_en %}
                            <div class="flex flex-col sm:flex-row gap-4">
                                <a href="{{ banner.button_link or '#' }}{% if '?' in (banner.button_link or '') %}&{% else %}?{% endif %}lang={{ lang }}" class="bg-accent text-dark px-8 py-4 rounded-full font-semibold text-lg hover:bg-opacity-90 transition text-center">
                                    {{ banner.button_text_vi if lang == 'vi' else banner.button_text_en }}
                                </a>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="slide active" data-slide="0">
                <div class="absolute inset-0">
                    <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?w=1920" alt="Lumora Resort" class="w-full h-full object-cover">
                    <div class="absolute inset-0 hero-gradient"></div>
                </div>
                <div class="slide-content relative h-full flex items-center">
                    <div class="container mx-auto px-4">
                        <div class="max-w-3xl text-white">
                            <span class="inline-block bg-accent text-dark px-4 py-1 rounded-full text-sm font-semibold mb-4">
                                {{ 'Khu Nghỉ Dưỡng Cao Cấp' if lang == 'vi' else 'Premium Resort' }}
                            </span>
                            <h1 class="text-4xl md:text-6xl lg:text-7xl font-display font-bold mb-6 leading-tight">
                                {{ 'Khám Phá Thiên Đường Nghỉ Dưỡng' if lang == 'vi' else 'Discover Paradise Resort' }}
                            </h1>
                            <p class="text-xl md:text-2xl mb-8 text-gray-200">
                                {{ 'Trải nghiệm kỳ nghỉ hoàn hảo với không gian xanh mát, tiện nghi sang trọng và dịch vụ tận tâm.' if lang == 'vi' else 'Experience the perfect vacation with green space, luxury amenities and dedicated service.' }}
                            </p>
                            <div class="flex flex-col sm:flex-row gap-4">
                                <a href="/contact?lang={{ lang }}#booking" class="bg-accent text-dark px-8 py-4 rounded-full font-semibold text-lg hover:bg-opacity-90 transition text-center">
                                    {{ 'Đặt Phòng Ngay' if lang == 'vi' else 'Book Now' }}
                                </a>
                                <a href="/accommodation?lang={{ lang }}" class="border-2 border-white text-white px-8 py-4 rounded-full font-semibold text-lg hover:bg-white hover:text-dark transition text-center">
                                    {{ 'Xem Các Phòng' if lang == 'vi' else 'View Rooms' }}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
    
    {% set slide_count = banners|length if banners and banners|length > 0 else 1 %}
    {% if slide_count > 1 %}
    <button id="prev-slide" class="absolute left-4 md:left-8 top-1/2 transform -translate-y-1/2 w-12 h-12 md:w-14 md:h-14 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/40 transition z-20">
        <i class="fas fa-chevron-left text-xl"></i>
    </button>
    <button id="next-slide" class="absolute right-4 md:right-8 top-1/2 transform -translate-y-1/2 w-12 h-12 md:w-14 md:h-14 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/40 transition z-20">
        <i class="fas fa-chevron-right text-xl"></i>
    </button>
    
    <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 flex items-center gap-3 z-20">
        {% for i in range(slide_count) %}
        <button class="slider-dot {% if loop.first %}active{% endif %} w-3 h-3 rounded-full bg-white/50 hover:bg-white transition" data-slide="{{ i }}"></button>
        {% endfor %}
    </div>
    {% endif %}
    
    <div class="absolute bottom-24 left-1/2 transform -translate-x-1/2 animate-bounce z-20">
        <a href="#intro" class="text-white text-3xl">
            <i class="fas fa-chevron-down"></i>
        </a>
    </div>
</section>

<!-- Quick Booking Bar -->
<section class="relative z-30 py-8 bg-light dark:bg-gray-900">
    <div class="container mx-auto px-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8">
            <form id="quick-booking-form" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 items-end">
                <!-- Check-in Date -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        <i class="fas fa-calendar-check mr-2 text-primary"></i>
                        {{ 'Ngày nhận phòng' if lang == 'vi' else 'Check-in Date' }}
                    </label>
                    <input type="date" name="checkin" id="quick-checkin" required
                           class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white">
                </div>
                
                <!-- Check-out Date -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        <i class="fas fa-calendar-minus mr-2 text-primary"></i>
                        {{ 'Ngày trả phòng' if lang == 'vi' else 'Check-out Date' }}
                    </label>
                    <input type="date" name="checkout" id="quick-checkout" required
                           class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white">
                </div>
                
                <!-- Adults -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        <i class="fas fa-user mr-2 text-primary"></i>
                        {{ 'Người lớn' if lang == 'vi' else 'Adults' }}
                    </label>
                    <select name="adults" id="quick-adults"
                            class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white">
                        <option value="1">1</option>
                        <option value="2" selected>2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </div>
                
                <!-- Children -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        <i class="fas fa-child mr-2 text-primary"></i>
                        {{ 'Trẻ em' if lang == 'vi' else 'Children' }}
                    </label>
                    <select name="children" id="quick-children"
                            class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white">
                        <option value="0" selected>0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
                
                <!-- Book Button -->
                <div>
                    <button type="submit" 
                            class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-3 px-6 rounded-lg transition duration-300 flex items-center justify-center gap-2 text-lg">
                        <i class="fas fa-search"></i>
                        {{ 'ĐẶT PHÒNG' if lang == 'vi' else 'BOOK NOW' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set minimum dates
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);
    
    const checkinInput = document.getElementById('quick-checkin');
    const checkoutInput = document.getElementById('quick-checkout');
    
    // Format date to YYYY-MM-DD
    const formatDate = (date) => date.toISOString().split('T')[0];
    
    checkinInput.min = formatDate(today);
    checkinInput.value = formatDate(today);
    checkoutInput.min = formatDate(tomorrow);
    checkoutInput.value = formatDate(tomorrow);
    
    // Update checkout min date when checkin changes
    checkinInput.addEventListener('change', function() {
        const checkinDate = new Date(this.value);
        const minCheckout = new Date(checkinDate);
        minCheckout.setDate(minCheckout.getDate() + 1);
        checkoutInput.min = formatDate(minCheckout);
        if (new Date(checkoutInput.value) <= checkinDate) {
            checkoutInput.value = formatDate(minCheckout);
        }
    });
    
    // Handle form submission
    document.getElementById('quick-booking-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const checkin = document.getElementById('quick-checkin').value;
        const checkout = document.getElementById('quick-checkout').value;
        const adults = document.getElementById('quick-adults').value;
        const children = document.getElementById('quick-children').value;
        
        // Redirect to booking page with pre-filled data
        const params = new URLSearchParams({
            lang: '{{ lang }}',
            checkin: checkin,
            checkout: checkout,
            adults: adults,
            children: children
        });
        
        window.location.href = '/contact?' + params.toString() + '#booking';
    });
});
</script>

<style>
@keyframes slideInLeft {
    from {
        opacity: 0;
        transform: translateX(-100px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}
@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}
.slide-in-left {
    opacity: 0;
    transform: translateX(-100px);
}
.slide-in-right {
    opacity: 0;
    transform: translateX(100px);
}
.slide-in-left.animated {
    animation: slideInLeft 0.8s ease-out forwards;
}
.slide-in-right.animated {
    animation: slideInRight 0.8s ease-out forwards;
}
</style>

<section id="intro" class="py-20 bg-white overflow-hidden">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="slide-in-left" id="intro-text">
                <span class="text-accent font-medium uppercase tracking-wider">{{ (sections.intro.subtitle_vi if lang == 'vi' else sections.intro.subtitle_en) if sections.intro and (sections.intro.subtitle_vi or sections.intro.subtitle_en) else ('Chào mừng đến với' if lang == 'vi' else 'Welcome to') }}</span>
                <h2 class="text-4xl md:text-5xl font-display font-bold text-dark mt-2 mb-6">{{ (sections.intro.title_vi if lang == 'vi' else sections.intro.title_en) if sections.intro and (sections.intro.title_vi or sections.intro.title_en) else 'Lumora Resort' }}</h2>
                <p class="text-gray-600 text-lg mb-6 leading-relaxed">
                    {{ (sections.intro.description_vi if lang == 'vi' else sections.intro.description_en) if sections.intro and (sections.intro.description_vi or sections.intro.description_en) else ('Lumora Resort là điểm đến lý tưởng cho những ai tìm kiếm sự yên bình giữa thiên nhiên kết hợp với tiện nghi hiện đại. Với không gian xanh mát rộng lớn, chúng tôi mang đến trải nghiệm nghỉ dưỡng đẳng cấp cho mọi du khách.' if lang == 'vi' else 'Lumora Resort is the ideal destination for those seeking peace in nature combined with modern amenities. With vast green space, we bring premium resort experience for all guests.') }}
                </p>
                <div class="flex flex-wrap gap-8">
                    <div class="text-center">
                        <span class="text-4xl font-bold text-primary">50+</span>
                        <p class="text-gray-500">{{ 'Phòng nghỉ' if lang == 'vi' else 'Rooms' }}</p>
                    </div>
                    <div class="text-center">
                        <span class="text-4xl font-bold text-primary">3</span>
                        <p class="text-gray-500">{{ 'Nhà hàng' if lang == 'vi' else 'Restaurants' }}</p>
                    </div>
                    <div class="text-center">
                        <span class="text-4xl font-bold text-primary">10+</span>
                        <p class="text-gray-500">{{ 'Tiện ích' if lang == 'vi' else 'Amenities' }}</p>
                    </div>
                    <div class="text-center">
                        <span class="text-4xl font-bold text-primary">5★</span>
                        <p class="text-gray-500">{{ 'Đánh giá' if lang == 'vi' else 'Rating' }}</p>
                    </div>
                </div>
            </div>
            <div class="relative slide-in-right" id="intro-video">
                <div class="aspect-video rounded-2xl overflow-hidden shadow-2xl">
                    <iframe 
                        class="w-full h-full"
                        src="https://www.youtube.com/embed/nCom4dIXfSs" 
                        title="Lumora Resort Video"
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
                <div class="absolute -bottom-6 -left-6 bg-accent text-dark p-6 rounded-xl shadow-lg hidden md:block">
                    <p class="text-2xl font-bold">5+</p>
                    <p class="text-sm">{{ 'Năm kinh nghiệm' if lang == 'vi' else 'Years of experience' }}</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const introObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animated');
            }
        });
    }, { threshold: 0.2 });
    
    const introText = document.getElementById('intro-text');
    const introVideo = document.getElementById('intro-video');
    if (introText) introObserver.observe(introText);
    if (introVideo) introObserver.observe(introVideo);
});
</script>

<section class="py-20 bg-primary">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <span class="text-accent font-medium uppercase tracking-wider">{{ (sections.amenities_section.subtitle_vi if lang == 'vi' else sections.amenities_section.subtitle_en) if sections.amenities_section and (sections.amenities_section.subtitle_vi or sections.amenities_section.subtitle_en) else ('Tiện Ích' if lang == 'vi' else 'Amenities') }}</span>
            <h2 class="text-4xl font-display font-bold text-white mt-2">{{ (sections.amenities_section.title_vi if lang == 'vi' else sections.amenities_section.title_en) if sections.amenities_section and (sections.amenities_section.title_vi or sections.amenities_section.title_en) else ('Tiện Ích Nổi Bật' if lang == 'vi' else 'Featured Amenities') }}</h2>
            {% if sections.amenities_section and (sections.amenities_section.description_vi or sections.amenities_section.description_en) %}
            <p class="text-gray-200 mt-4 max-w-2xl mx-auto">{{ sections.amenities_section.description_vi if lang == 'vi' else sections.amenities_section.description_en }}</p>
            {% endif %}
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            {% for key, amenity in amenities.items() %}
            <div class="group bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition">
                <div class="relative overflow-hidden h-56">
                    {% if amenity.images and amenity.images|length > 0 %}
                    <img src="{{ amenity.images[0] }}" alt="{{ amenity.name[lang] }}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                    {% else %}
                    <div class="w-full h-full bg-primary flex items-center justify-center">
                        {% if key == 'zoo' %}
                        <i class="fas fa-paw text-6xl text-white opacity-50"></i>
                        {% elif key == 'garden' %}
                        <i class="fas fa-leaf text-6xl text-white opacity-50"></i>
                        {% else %}
                        <i class="fas fa-swimming-pool text-6xl text-white opacity-50"></i>
                        {% endif %}
                    </div>
                    {% endif %}
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                    <div class="absolute bottom-4 left-4 right-4">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 rounded-full bg-accent flex items-center justify-center">
                                {% if key == 'zoo' %}
                                <i class="fas fa-paw text-xl text-dark"></i>
                                {% elif key == 'garden' %}
                                <i class="fas fa-leaf text-xl text-dark"></i>
                                {% else %}
                                <i class="fas fa-swimming-pool text-xl text-dark"></i>
                                {% endif %}
                            </div>
                            <h3 class="text-xl font-display font-bold text-white">{{ amenity.name[lang] }}</h3>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <p class="text-gray-600 mb-4 line-clamp-3">{{ amenity.description[lang] }}</p>
                    <a href="/amenities#{{ key }}?lang={{ lang }}" class="text-primary font-semibold hover:text-accent transition inline-flex items-center gap-2">
                        {{ 'Xem Chi Tiết' if lang == 'vi' else 'View Details' }}
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-10">
            <a href="/amenities?lang={{ lang }}" class="inline-block bg-primary text-white px-8 py-3 rounded-full font-semibold hover:bg-opacity-90 transition">
                {{ 'Khám Phá Thêm' if lang == 'vi' else 'Explore More' }}
            </a>
        </div>
    </div>
</section>

<!-- STEAM Education Section -->
<section class="py-20 bg-light dark:bg-gray-900">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="order-2 lg:order-1">
                <span class="text-accent font-medium uppercase tracking-wider">{{ (sections.steam.subtitle_vi if lang == 'vi' else sections.steam.subtitle_en) if sections.steam and (sections.steam.subtitle_vi or sections.steam.subtitle_en) else ('Giáo Dục STEAM' if lang == 'vi' else 'STEAM Education') }}</span>
                <h2 class="text-4xl font-display font-bold text-dark dark:text-white mt-2 mb-6">
                    {{ (sections.steam.title_vi if lang == 'vi' else sections.steam.title_en) if sections.steam and (sections.steam.title_vi or sections.steam.title_en) else ('Học Tập Qua Trải Nghiệm Thực Tế' if lang == 'vi' else 'Learning Through Real Experience') }}
                </h2>
                <p class="text-gray-600 dark:text-gray-300 mb-6 text-lg leading-relaxed">
                    {{ (sections.steam.description_vi if lang == 'vi' else sections.steam.description_en) if sections.steam and (sections.steam.description_vi or sections.steam.description_en) else ('Lumora Resort mang đến chương trình giáo dục STEAM độc đáo, kết hợp giữa Khoa học, Công nghệ, Kỹ thuật, Nghệ thuật và Toán học. Trẻ em sẽ được học tập thông qua các hoạt động thực hành, khám phá thiên nhiên và phát triển tư duy sáng tạo.' if lang == 'vi' else 'Lumora Resort offers a unique STEAM education program, combining Science, Technology, Engineering, Arts and Mathematics. Children will learn through hands-on activities, nature exploration and creative thinking development.') }}
                </p>
                
                <div class="grid grid-cols-2 gap-4 mb-8">
                    {% if sections.steam and sections.steam.section_items %}
                    {% for item in sections.steam.section_items %}
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center">
                            <i class="{{ item.icon or 'fas fa-star' }} text-primary text-xl"></i>
                        </div>
                        <span class="font-medium text-dark dark:text-white">{{ item.title_vi if lang == 'vi' else item.title_en }}</span>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center">
                            <i class="fas fa-flask text-primary text-xl"></i>
                        </div>
                        <span class="font-medium text-dark dark:text-white">{{ 'Khoa học' if lang == 'vi' else 'Science' }}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center">
                            <i class="fas fa-laptop-code text-primary text-xl"></i>
                        </div>
                        <span class="font-medium text-dark dark:text-white">{{ 'Công nghệ' if lang == 'vi' else 'Technology' }}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center">
                            <i class="fas fa-cogs text-primary text-xl"></i>
                        </div>
                        <span class="font-medium text-dark dark:text-white">{{ 'Kỹ thuật' if lang == 'vi' else 'Engineering' }}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center">
                            <i class="fas fa-palette text-primary text-xl"></i>
                        </div>
                        <span class="font-medium text-dark dark:text-white">{{ 'Nghệ thuật' if lang == 'vi' else 'Arts' }}</span>
                    </div>
                    {% endif %}
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4">
                    <a href="{{ sections.steam.button_link if sections.steam and sections.steam.button_link else '/steam/intro' }}?lang={{ lang }}" class="bg-primary text-white px-8 py-3 rounded-full font-semibold hover:bg-opacity-90 transition text-center">
                        {{ (sections.steam.button_text_vi if lang == 'vi' else sections.steam.button_text_en) if sections.steam and (sections.steam.button_text_vi or sections.steam.button_text_en) else ('Tìm Hiểu Thêm' if lang == 'vi' else 'Learn More') }}
                    </a>
                    <a href="{{ sections.steam.button2_link if sections.steam and sections.steam.button2_link else '/steam/register' }}?lang={{ lang }}" class="border-2 border-primary text-primary px-8 py-3 rounded-full font-semibold hover:bg-primary hover:text-white transition text-center">
                        {{ (sections.steam.button2_text_vi if lang == 'vi' else sections.steam.button2_text_en) if sections.steam and (sections.steam.button2_text_vi or sections.steam.button2_text_en) else ('Đăng Ký Ngay' if lang == 'vi' else 'Register Now') }}
                    </a>
                </div>
            </div>
            
            <div class="order-1 lg:order-2">
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-4">
                        <img src="{{ sections.steam.image1_url if sections.steam and sections.steam.image1_url else 'https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=400&h=300&fit=crop' }}" alt="STEAM Education" class="rounded-2xl shadow-lg w-full h-40 object-cover">
                        <img src="{{ sections.steam.image2_url if sections.steam and sections.steam.image2_url else 'https://images.unsplash.com/photo-1567168544813-cc03465b4fa8?w=400&h=400&fit=crop' }}" alt="Science Activities" class="rounded-2xl shadow-lg w-full h-52 object-cover">
                    </div>
                    <div class="space-y-4 pt-8">
                        <img src="{{ sections.steam.image3_url if sections.steam and sections.steam.image3_url else 'https://images.unsplash.com/photo-1581092918056-0c4c3acd3789?w=400&h=400&fit=crop' }}" alt="Kids Learning" class="rounded-2xl shadow-lg w-full h-52 object-cover">
                        <img src="{{ sections.steam.image4_url if sections.steam and sections.steam.image4_url else 'https://images.unsplash.com/photo-1596496181871-9681eacf9764?w=400&h=300&fit=crop' }}" alt="Nature Exploration" class="rounded-2xl shadow-lg w-full h-40 object-cover">
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="py-20 bg-light">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <span class="text-accent font-medium uppercase tracking-wider">{{ (sections.rooms_section.subtitle_vi if lang == 'vi' else sections.rooms_section.subtitle_en) if sections.rooms_section and (sections.rooms_section.subtitle_vi or sections.rooms_section.subtitle_en) else ('Lưu Trú' if lang == 'vi' else 'Accommodation') }}</span>
            <h2 class="text-4xl font-display font-bold text-dark mt-2">{{ (sections.rooms_section.title_vi if lang == 'vi' else sections.rooms_section.title_en) if sections.rooms_section and (sections.rooms_section.title_vi or sections.rooms_section.title_en) else ('Phòng Nghỉ Của Chúng Tôi' if lang == 'vi' else 'Our Rooms') }}</h2>
            {% if sections.rooms_section and (sections.rooms_section.description_vi or sections.rooms_section.description_en) %}
            <p class="text-gray-600 mt-4 max-w-2xl mx-auto">{{ sections.rooms_section.description_vi if lang == 'vi' else sections.rooms_section.description_en }}</p>
            {% endif %}
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for key, room in rooms.items() %}
            <div class="bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition group">
                <div class="relative overflow-hidden h-64">
                    <img src="{{ room.images[0] }}" alt="{{ room.name[lang] }}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                    <div class="absolute top-4 right-4 bg-accent text-dark px-4 py-2 rounded-full font-semibold z-10 group-hover:opacity-0 transition-opacity duration-300">
                        {{ '{:,.0f}'.format(room.price) }}đ/{{ 'đêm' if lang == 'vi' else 'night' }}
                    </div>
                    <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-start p-4">
                        <div class="text-white space-y-2">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-ruler-combined text-accent w-5"></i>
                                <span class="text-sm">{{ room.area }}m²</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-bed text-accent w-5"></i>
                                <span class="text-sm">{{ room.bed_count or 1 }} {{ room.bed_type[lang] if room.bed_type and room.bed_type[lang] else ('giường' if lang == 'vi' else 'bed') }}</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-user text-accent w-5"></i>
                                <span class="text-sm">{{ room.adults_capacity or room.capacity or 2 }} {{ 'người lớn' if lang == 'vi' else 'adults' }}</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-child text-accent w-5"></i>
                                <span class="text-sm">{{ room.children_capacity or 0 }} {{ 'trẻ em' if lang == 'vi' else 'children' }}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-display font-bold text-dark mb-2">{{ room.name[lang] }}</h3>
                    <p class="text-gray-600 mb-4 line-clamp-2">{{ room.description[lang] }}</p>
                    <a href="/accommodation/{{ room.id }}?lang={{ lang }}" class="block w-full bg-primary text-white text-center py-3 rounded-full hover:bg-opacity-90 transition">
                        {{ 'Xem Chi Tiết' if lang == 'vi' else 'View Details' }}
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-10">
            <a href="/accommodation?lang={{ lang }}" class="inline-block border-2 border-primary text-primary px-8 py-3 rounded-full font-semibold hover:bg-primary hover:text-white transition">
                {{ 'Xem Tất Cả Phòng' if lang == 'vi' else 'View All Rooms' }}
            </a>
        </div>
    </div>
</section>

<section class="py-20 bg-white">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <span class="text-accent font-medium uppercase tracking-wider">{{ 'Tin Tức' if lang == 'vi' else 'News' }}</span>
            <h2 class="text-4xl font-display font-bold text-dark mt-2">{{ 'Tin Tức & Ưu Đãi' if lang == 'vi' else 'News & Offers' }}</h2>
        </div>
        
        <div class="relative">
            <button id="news-prev" class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 lg:-translate-x-8 z-10 w-12 h-12 bg-white shadow-lg rounded-full flex items-center justify-center text-primary hover:bg-primary hover:text-white transition disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas fa-chevron-left text-xl"></i>
            </button>
            
            <div id="news-slider" class="overflow-hidden">
                <div id="news-track" class="flex transition-transform duration-500 ease-in-out">
                    {% for article in news %}
                    <div class="news-slide flex-shrink-0 w-full md:w-1/3 px-4">
                        <div class="bg-light rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition group h-full">
                            <div class="relative overflow-hidden">
                                <img src="{{ article.image }}" alt="{{ article.title[lang] }}" class="w-full h-48 object-cover group-hover:scale-110 transition duration-500">
                                <div class="absolute top-4 left-4 bg-accent text-dark px-3 py-1 rounded-full text-sm font-medium">
                                    {{ article.category[lang] }}
                                </div>
                            </div>
                            <div class="p-6">
                                <p class="text-gray-500 text-sm mb-2"><i class="far fa-calendar mr-1"></i> {{ article.date }}</p>
                                <h3 class="text-lg font-display font-bold text-dark mb-2 line-clamp-2">{{ article.title[lang] }}</h3>
                                <p class="text-gray-600 mb-4 line-clamp-2">{{ article.excerpt[lang] }}</p>
                                <a href="/news/{{ article.id }}?lang={{ lang }}" class="text-primary font-medium hover:text-accent transition">
                                    {{ 'Đọc thêm' if lang == 'vi' else 'Read more' }} <i class="fas fa-arrow-right ml-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <button id="news-next" class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 lg:translate-x-8 z-10 w-12 h-12 bg-white shadow-lg rounded-full flex items-center justify-center text-primary hover:bg-primary hover:text-white transition disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas fa-chevron-right text-xl"></i>
            </button>
        </div>
        
        <div class="text-center mt-10">
            <a href="/news?lang={{ lang }}" class="inline-block border-2 border-primary text-primary px-8 py-3 rounded-full font-semibold hover:bg-primary hover:text-white transition">
                {{ 'Xem Tất Cả Tin Tức' if lang == 'vi' else 'View All News' }}
            </a>
        </div>
    </div>
</section>

<section class="py-20 bg-secondary text-white">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-4xl md:text-5xl font-display font-bold mb-6">
                {{ 'Sẵn Sàng Cho Kỳ Nghỉ Hoàn Hảo?' if lang == 'vi' else 'Ready For A Perfect Vacation?' }}
            </h2>
            <p class="text-xl text-gray-200 mb-8">
                {{ 'Liên hệ ngay với chúng tôi để đặt phòng và nhận ưu đãi đặc biệt.' if lang == 'vi' else 'Contact us now to book and receive special offers.' }}
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="/contact?lang={{ lang }}#booking" class="bg-accent text-dark px-8 py-4 rounded-full font-semibold text-lg hover:bg-opacity-90 transition">
                    {{ 'Đặt Phòng Ngay' if lang == 'vi' else 'Book Now' }}
                </a>
                <a href="tel:0918556738" class="border-2 border-white text-white px-8 py-4 rounded-full font-semibold text-lg hover:bg-white hover:text-dark transition">
                    <i class="fas fa-phone mr-2"></i> 0918556738
                </a>
            </div>
            
            <!-- Newsletter Subscription -->
            <div class="mt-12 pt-10 border-t border-white/20">
                <div class="flex items-center justify-center gap-3 mb-3">
                    <i class="fas fa-envelope text-accent text-3xl"></i>
                    <h3 class="text-2xl font-display">
                        {{ 'Đăng Ký Nhận Tin Khuyến Mãi' if lang == 'vi' else 'Subscribe for Promotions' }}
                    </h3>
                </div>
                <p class="text-gray-200 mb-6">
                    {{ 'Nhận thông tin về các chương trình khuyến mãi và sự kiện sắp diễn ra của Lumora Resort.' if lang == 'vi' else 'Get updates on promotions and upcoming events at Lumora Resort.' }}
                </p>
                <form id="newsletter-form" class="flex flex-col sm:flex-row gap-3 justify-center max-w-xl mx-auto">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="email" id="newsletter-email" name="email" required 
                           placeholder="{{ 'Nhập email của bạn...' if lang == 'vi' else 'Enter your email...' }}" 
                           class="flex-1 px-6 py-3 rounded-full text-dark focus:outline-none focus:ring-2 focus:ring-accent">
                    <button type="submit" class="bg-accent text-dark px-8 py-3 rounded-full font-semibold hover:bg-opacity-90 transition whitespace-nowrap">
                        <i class="fas fa-paper-plane mr-2"></i>{{ 'Đăng Ký' if lang == 'vi' else 'Subscribe' }}
                    </button>
                </form>
                <p id="newsletter-message" class="mt-4 text-sm hidden"></p>
            </div>
        </div>
    </div>
</section>

<!-- Google Maps Section -->
<section class="py-16 bg-light">
    <div class="container mx-auto px-4">
        <div class="text-center mb-10">
            <span class="text-accent font-medium uppercase tracking-wider">{{ 'Vị Trí' if lang == 'vi' else 'Location' }}</span>
            <h2 class="text-4xl font-display font-bold text-dark mt-2">{{ 'Tìm Đường Đến Lumora Resort' if lang == 'vi' else 'Find Your Way To Lumora Resort' }}</h2>
            <p class="text-gray-600 mt-4 max-w-2xl mx-auto">
                {{ 'Lumora Resort tọa lạc tại vị trí đắc địa, dễ dàng tiếp cận từ trung tâm thành phố.' if lang == 'vi' else 'Lumora Resort is located in a prime location, easily accessible from the city center.' }}
            </p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
            <!-- Contact Info -->
            <div class="bg-white rounded-2xl p-8 shadow-lg">
                <h3 class="text-xl font-display font-bold text-dark mb-6">{{ 'Thông Tin Liên Hệ' if lang == 'vi' else 'Contact Information' }}</h3>
                
                <div class="space-y-5">
                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-map-marker-alt text-primary text-xl"></i>
                        </div>
                        <div>
                            <p class="font-medium text-dark">{{ 'Địa chỉ' if lang == 'vi' else 'Address' }}</p>
                            <p class="text-gray-600 text-sm mt-1">{{ 'Khu trải nghiệm Bigsun, xã Hữu Bằng, Hải Phòng' if lang == 'vi' else 'Bigsun Experience Zone, Huu Bang Commune, Hai Phong' }}</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-phone text-primary text-xl"></i>
                        </div>
                        <div>
                            <p class="font-medium text-dark">{{ 'Điện thoại' if lang == 'vi' else 'Phone' }}</p>
                            <a href="tel:0918556738" class="text-primary hover:text-accent transition text-sm mt-1 block">0918 556 738</a>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-envelope text-primary text-xl"></i>
                        </div>
                        <div>
                            <p class="font-medium text-dark">Email</p>
                            <a href="mailto:info@lumoraresort.com" class="text-primary hover:text-accent transition text-sm mt-1 block">info@lumoraresort.com</a>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-clock text-primary text-xl"></i>
                        </div>
                        <div>
                            <p class="font-medium text-dark">{{ 'Giờ làm việc' if lang == 'vi' else 'Working Hours' }}</p>
                            <p class="text-gray-600 text-sm mt-1">{{ 'Hàng ngày: 6:00 - 22:00' if lang == 'vi' else 'Daily: 6:00 AM - 10:00 PM' }}</p>
                        </div>
                    </div>
                </div>
                
                <a href="/contact?lang={{ lang }}" class="mt-6 block w-full bg-primary text-white text-center py-3 rounded-full font-semibold hover:bg-opacity-90 transition">
                    {{ 'Liên Hệ Ngay' if lang == 'vi' else 'Contact Us' }}
                </a>
            </div>
            
            <!-- Google Map -->
            <div class="lg:col-span-2">
                <div class="rounded-2xl overflow-hidden shadow-lg h-[350px] lg:h-[450px]">
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d10663.833523583402!2d106.66755129951537!3d20.757015628649633!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x314a713966b1a4d5%3A0x578c84b50d78cbd8!2sBig%20Sun!5e0!3m2!1svi!2s!4v1767453421027!5m2!1svi!2s" 
                        width="100%" 
                        height="100%" 
                        style="border:0;" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade"
                        title="Lumora Resort Location">
                    </iframe>
                </div>
                <div class="mt-4 flex flex-wrap gap-3 justify-center lg:justify-start">
                    <a href="https://www.google.com/maps/dir//Big+Sun,+Huu+Bang,+Hai+Phong,+Vietnam" target="_blank" class="inline-flex items-center gap-2 bg-white px-5 py-2 rounded-full shadow text-primary hover:bg-primary hover:text-white transition">
                        <i class="fas fa-directions"></i>
                        {{ 'Chỉ đường' if lang == 'vi' else 'Get Directions' }}
                    </a>
                    <a href="https://www.google.com/maps/place/Big+Sun" target="_blank" class="inline-flex items-center gap-2 bg-white px-5 py-2 rounded-full shadow text-gray-700 hover:bg-gray-100 transition">
                        <i class="fas fa-external-link-alt"></i>
                        {{ 'Xem trên Google Maps' if lang == 'vi' else 'View on Google Maps' }}
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.slider-dot');
    const prevBtn = document.getElementById('prev-slide');
    const nextBtn = document.getElementById('next-slide');
    
    if (slides.length === 0) return;
    
    let currentSlide = 0;
    let autoSlideInterval;
    const slideInterval = 6000;
    
    function showSlide(index) {
        slides.forEach(slide => slide.classList.remove('active'));
        dots.forEach(dot => dot.classList.remove('active'));
        
        if (index >= slides.length) index = 0;
        if (index < 0) index = slides.length - 1;
        
        currentSlide = index;
        slides[currentSlide].classList.add('active');
        dots[currentSlide].classList.add('active');
    }
    
    function nextSlide() {
        showSlide(currentSlide + 1);
    }
    
    function prevSlide() {
        showSlide(currentSlide - 1);
    }
    
    function startAutoSlide() {
        autoSlideInterval = setInterval(nextSlide, slideInterval);
    }
    
    function stopAutoSlide() {
        clearInterval(autoSlideInterval);
    }
    
    function resetAutoSlide() {
        stopAutoSlide();
        startAutoSlide();
    }
    
    if (prevBtn) {
        prevBtn.addEventListener('click', function() {
            prevSlide();
            resetAutoSlide();
        });
    }
    
    if (nextBtn) {
        nextBtn.addEventListener('click', function() {
            nextSlide();
            resetAutoSlide();
        });
    }
    
    dots.forEach((dot, index) => {
        dot.addEventListener('click', function() {
            showSlide(index);
            resetAutoSlide();
        });
    });
    
    const heroSlider = document.getElementById('hero-slider');
    if (heroSlider) {
        heroSlider.addEventListener('mouseenter', stopAutoSlide);
        heroSlider.addEventListener('mouseleave', startAutoSlide);
        
        let touchStartX = 0;
        let touchEndX = 0;
        
        heroSlider.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
            stopAutoSlide();
        }, {passive: true});
        
        heroSlider.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
            startAutoSlide();
        }, {passive: true});
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    nextSlide();
                } else {
                    prevSlide();
                }
            }
        }
    }
    
    startAutoSlide();
    
    // News Slider
    const newsTrack = document.getElementById('news-track');
    const newsPrevBtn = document.getElementById('news-prev');
    const newsNextBtn = document.getElementById('news-next');
    const newsSlides = document.querySelectorAll('.news-slide');
    
    if (newsTrack && newsSlides.length > 0) {
        let newsCurrentIndex = 0;
        let newsItemsPerView = window.innerWidth >= 768 ? 3 : 1;
        
        function getNewsMaxIndex() {
            return Math.max(0, newsSlides.length - newsItemsPerView);
        }
        
        function updateNewsSlider() {
            const slideWidth = newsSlides[0].offsetWidth;
            newsTrack.style.transform = `translateX(-${newsCurrentIndex * slideWidth}px)`;
            
            const maxIndex = getNewsMaxIndex();
            if (newsPrevBtn) newsPrevBtn.disabled = newsCurrentIndex <= 0;
            if (newsNextBtn) newsNextBtn.disabled = newsCurrentIndex >= maxIndex;
        }
        
        function updateNewsItemsPerView() {
            newsItemsPerView = window.innerWidth >= 768 ? 3 : 1;
            const maxIndex = getNewsMaxIndex();
            newsCurrentIndex = Math.min(newsCurrentIndex, maxIndex);
            updateNewsSlider();
        }
        
        if (newsPrevBtn) {
            newsPrevBtn.addEventListener('click', function() {
                if (newsCurrentIndex > 0) {
                    newsCurrentIndex--;
                    updateNewsSlider();
                }
            });
        }
        
        if (newsNextBtn) {
            newsNextBtn.addEventListener('click', function() {
                const maxIndex = getNewsMaxIndex();
                if (newsCurrentIndex < maxIndex) {
                    newsCurrentIndex++;
                    updateNewsSlider();
                }
            });
        }
        
        window.addEventListener('resize', updateNewsItemsPerView);
        setTimeout(updateNewsSlider, 100);
    }
    
    // Newsletter form handling
    const newsletterForm = document.getElementById('newsletter-form');
    const newsletterMessage = document.getElementById('newsletter-message');
    const newsletterEmail = document.getElementById('newsletter-email');
    
    if (newsletterForm) {
        newsletterForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = newsletterEmail.value.trim();
            if (!email) return;
            
            const lang = '{{ lang }}';
            
            fetch('/api/newsletter', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email: email, lang: lang })
            })
            .then(response => response.json())
            .then(data => {
                newsletterMessage.textContent = data.message;
                newsletterMessage.classList.remove('hidden');
                
                if (data.success) {
                    newsletterMessage.classList.remove('text-red-300');
                    newsletterMessage.classList.add('text-green-300');
                    newsletterEmail.value = '';
                } else {
                    newsletterMessage.classList.remove('text-green-300');
                    newsletterMessage.classList.add('text-red-300');
                }
                
                setTimeout(() => {
                    newsletterMessage.classList.add('hidden');
                }, 5000);
            })
            .catch(error => {
                console.error('Error:', error);
                newsletterMessage.textContent = lang === 'vi' ? 'Có lỗi xảy ra, vui lòng thử lại.' : 'An error occurred, please try again.';
                newsletterMessage.classList.remove('hidden', 'text-green-300');
                newsletterMessage.classList.add('text-red-300');
            });
        });
    }
});
</script>
{% endblock extra_scripts %}
